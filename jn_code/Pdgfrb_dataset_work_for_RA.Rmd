---
title: "Exploration of Adamts1 and Adamts5 in the INTACT and DKD datasets"
author: "Jonathan Nelson"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    toc: yes
    toc_depth: 3
    toc_float: yes
    number_sections: yes
    theme: journal
    df_print: paged
    code_folding: hide
    highlight: pygments
  pdf_document:
    toc: yes
    toc_depth: '3'
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Install Packages 

```{r load new packages, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}

knitr::opts_chunk$set(echo = TRUE)
if (!require("dplyr")) {install.packages("dplyr"); require("dplyr")}
if (!require("Seurat")) {install.packages("Seurat"); require("Seurat")}
if (!require("patchwork")) {install.packages("patchwork"); require("patchwork")}
if (!require("knitr")) {install.packages("knitr"); require("knitr")}
if (!require("ggplot2")) {install.packages("ggplot2"); require("ggplot2")}
if (!require("BiocManager")) {install.packages("BiocManager"); require("BiocManager")}
if (!require("ggpmisc")) {install.packages("ggpmisc"); require("ggpmisc")}
if (!require("here")) {install.packages("here"); require("here")}
if (!require("devtools")) {install.packages("devtools"); require("devtools")}
if (!require("tidyverse")) {install.packages("tidyverse"); require("tidyverse")}
if (!require("openxlsx")) {install.packages("openxlsx"); require("openxlsx")}
if (!require("sjmisc")) {install.packages("sjmisc"); require("sjmisc")}
if (!require("gridExtra")) {install.packages("gridExtra"); require("gridExtra")}
if (!require("gplots")) {install.packages("gplots"); require("gplots")}
if (!require("ggvenn")) {install.packages("ggvenn"); require("ggvenn")}
if (!require("ggrepel")) {install.packages("ggrepel"); require("ggrepel")}


set.seed(12345)
#here::set_here()
here()
```

# Introduction 

The goal of this file is to explore the expression of Adamts1 and Adamts5 in the INTACT and DKD datasets. The INTACT dataset was generated by Jonathan Nelson and the DKD dataset was generated in the Humphreys lab (PMID: 35709763). The SO.DKD cells were extracted from the Humphreys lab dataset by their annotation as "celltype = JGA" and then QC'd and annotated by Jonathan Nelson.

# Load Nelson INTACT Dataset

```{r echo=TRUE, warning=FALSE, error=FALSE, results = TRUE, message=FALSE, fig.align = 'center'}

SO.INTACT <- readRDS(here("Datasets", "renamed", "INTACT_JGA_renamed.rds"))
DimPlot(SO.INTACT, group.by = "class.JGA")

SO.INTACT

```

## Expression of Adamts1 and Adamts5

```{r echo=TRUE, warning=FALSE, error=FALSE, results = TRUE, message=FALSE, fig.align = 'center'}

FeaturePlot(SO.INTACT, "Adamts1", order = T)

VlnPlot(SO.INTACT, "Adamts1")

FeaturePlot(SO.INTACT, "Adamts5", order = T)

VlnPlot(SO.INTACT, "Adamts5")

```


# Load DKD Dataset 

```{r echo=TRUE, warning=FALSE, error=FALSE, results = TRUE, message=FALSE, fig.align = 'center'}

SO.DKD <- readRDS(here("Datasets", "renamed", "DKD_JGA_renamed.rds"))

Idents(SO.DKD) <- SO.DKD@meta.data$class.JGA

DimPlot(SO.DKD, group.by = "class.JGA", reduction = "umap")

SO.DKD

```

## Expression of Adamts1 and Adamts5


```{r echo=TRUE, warning=FALSE, error=FALSE, results = TRUE, message=FALSE, fig.align = 'center'}

FeaturePlot(SO.DKD, "Adamts1", order = T)

VlnPlot(SO.DKD, "Adamts1")

FeaturePlot(SO.DKD, "Adamts5", order = T)

VlnPlot(SO.DKD, "Adamts5")

```

## Expression of Adamts1 and Adamts5 split by experimental condition

```{r echo=TRUE, warning=FALSE, error=FALSE, results = TRUE, message=FALSE, fig.align = 'center'}

head(SO.DKD@meta.data)

unique(SO.DKD@meta.data$group)

unique(SO.DKD@meta.data$group2)

```

```{r echo=TRUE, warning=FALSE, error=FALSE, results = TRUE, message=FALSE, fig.align = 'center', fig.width = 16}

VlnPlot(SO.DKD, "Adamts1", split.by = "group")

VlnPlot(SO.DKD, "Adamts1", split.by = "group2")


VlnPlot(SO.DKD, "Adamts5", split.by = "group")

VlnPlot(SO.DKD, "Adamts5", split.by = "group2")

```

# Session Info

```{r sessioninfo, echo=TRUE, warning=FALSE, error=FALSE, message=FALSE, fig.align = 'center'}

sessionInfo()

```


